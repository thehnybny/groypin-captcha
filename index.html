<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Turnstile</title>
    <style>
      body { margin:0; padding:16px; font-family: system-ui, sans-serif; }
      #cf { display:flex; justify-content:center; margin-top:12px; }
      .hint { font-size:14px; opacity:.7; text-align:center; }
    </style>

    <script>
      // Read params for the onload handler
      const params  = new URLSearchParams(location.search);
      const sitekey = params.get('sitekey');
      const action  = params.get('action') || 'signin';

      function done(token) {
        if (window.TokenChannel && window.TokenChannel.postMessage) {
          window.TokenChannel.postMessage(token);
        } else {
          location.href = 'turnstile://token/' + encodeURIComponent(token);
        }
      }
      function fail() {
        if (window.TokenChannel && window.TokenChannel.postMessage) {
          window.TokenChannel.postMessage('');
        } else {
          location.href = 'turnstile://token/';
        }
      }

      // Called when the Turnstile script has loaded
      function onloadTurnstileCallback() {
        // appearance: "execute" => renders then auto-runs
        turnstile.render('#cf', {
          sitekey,
          action,
          theme: 'auto',
          appearance: 'execute',
          callback: done,
          'error-callback': fail,
          'timeout-callback': fail,
          retry: 'auto'
        });
      }
    </script>

    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onloadTurnstileCallback" async defer></script>
  </head>
  <body>
    <div class="hint">Completing verificationâ€¦</div>
    <div id="cf"></div>
  </body>
</html>
